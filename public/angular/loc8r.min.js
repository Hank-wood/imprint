(function(){angular.module("loc8rApp",["ngRoute","ngSanitize","ui.bootstrap"]);function e(e,r){e.when("/",{templateUrl:"/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});r.html5Mode(true)}angular.module("loc8rApp").config(["$routeProvider","$locationProvider",e])})();(function(){angular.module("loc8rApp").controller("homeCtrl",e);e.$inject=["$scope"];function e(e){if(window.location.pathname!=="/"){window.location.href="/#"+window.location.pathname}var r=this;console.log(window.location);r.pageHeader={title:"Loc8r",strapline:"Find places to work with wifi near you!"};r.sidebar={content:"Looking for wifi and a seat? Loc8r helps you find places to work when out and about. Perhaps with coffee, cake or a pint? Let Loc8r help you find the place you're looking for."};r.message="Checking your location"}})();(function(){angular.module("loc8rApp").controller("loginCtrl",e);e.$inject=["$location","authentication"];function e(e,r){var o=this;o.pageHeader={title:"Sign in to Loc8r"};o.credentials={email:"",password:""};o.returnPage=e.search().page||"/";o.onSubmit=function(){o.formError="";if(!o.credentials.email||!o.credentials.password){o.formError="All fields required, please try again";return false}else{o.doLogin()}};o.doLogin=function(){o.formError="";r.login(o.credentials).error(function(e){o.formError=e}).then(function(){e.search("page",null);e.path(o.returnPage)})}}})();(function(){angular.module("loc8rApp").controller("registerCtrl",e);e.$inject=["$location","authentication"];function e(e,r){var o=this;o.pageHeader={title:"Create a new Loc8r account"};o.credentials={name:"",email:"",password:""};o.returnPage=e.search().page||"/";o.onSubmit=function(){o.formError="";if(!o.credentials.name||!o.credentials.email||!o.credentials.password){o.formError="All fields required, please try again";return false}else{o.doRegister()}};o.doRegister=function(){o.formError="";r.register(o.credentials).error(function(e){o.formError=e}).then(function(){e.search("page",null);e.path(o.returnPage)})}}})();(function(){angular.module("loc8rApp").service("authentication",e);e.$inject=["$http","$window"];function e(e,r){var o=function(e){r.localStorage["loc8r-token"]=e};var t=function(){return r.localStorage["loc8r-token"]};var n=function(){var e=t();if(e){var o=JSON.parse(r.atob(e.split(".")[1]));return o.exp>Date.now()/1e3}else{return false}};var i=function(){if(n()){var e=t();var o=JSON.parse(r.atob(e.split(".")[1]));return{email:o.email,name:o.name}}};register=function(r){return e.post("/api/register",r).success(function(e){o(e.token)})};login=function(r){return e.post("/api/login",r).success(function(e){o(e.token)})};logout=function(){r.localStorage.removeItem("loc8r-token")};return{currentUser:i,saveToken:o,getToken:t,isLoggedIn:n,register:register,login:login,logout:logout}}})();(function(){angular.module("loc8rApp").controller("navigationCtrl",e);e.$inject=["$location","authentication"];function e(e,r){var o=this;o.currentPath=e.path();o.isLoggedIn=r.isLoggedIn();o.currentUser=r.currentUser();o.logout=function(){r.logout();e.path("#/")}}})();(function(){angular.module("loc8rApp").directive("navigation",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html",controller:"navigationCtrl as navvm"}}})();(function(){angular.module("loc8rApp").directive("footerGeneric",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}})();(function(){angular.module("loc8rApp").directive("pageHeader",e);function e(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}})();