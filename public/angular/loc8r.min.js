(function(){angular.module("ImprintApp",["ngRoute","ngSanitize","ui.bootstrap"]);function e(e,t){e.when("/",{templateUrl:"/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});t.html5Mode(true)}angular.module("ImprintApp").config(["$routeProvider","$locationProvider",e])})();(function(){angular.module("ImprintApp").controller("homeCtrl",e);e.$inject=["$scope"];function e(e){if(window.location.pathname!=="/"){window.location.href="/#"+window.location.pathname}var t=this;console.log(window.location);t.pageHeader={title:"Imprint",strapline:"MEAN Stack User Authentication Application"}}})();(function(){angular.module("ImprintApp").controller("loginCtrl",e);e.$inject=["$location","authentication"];function e(e,t){var r=this;r.pageHeader={title:"Sign in to Imprint"};r.credentials={email:"",password:""};r.returnPage=e.search().page||"/";r.onSubmit=function(){r.formError="";if(!r.credentials.email||!r.credentials.password){r.formError="All fields required, please try again";return false}else{r.doLogin()}};r.doLogin=function(){r.formError="";t.login(r.credentials).error(function(e){r.formError=e}).then(function(){e.search("page",null);e.path(r.returnPage)})}}})();(function(){angular.module("ImprintApp").controller("registerCtrl",e);e.$inject=["$location","authentication"];function e(e,t){var r=this;r.pageHeader={title:"Create a new Imprint account"};r.credentials={name:"",email:"",password:""};r.returnPage=e.search().page||"/";r.onSubmit=function(){r.formError="";if(!r.credentials.name||!r.credentials.email||!r.credentials.password){r.formError="All fields required, please try again";return false}else{r.doRegister()}};r.doRegister=function(){r.formError="";t.register(r.credentials).error(function(e){r.formError=e}).then(function(){e.search("page",null);e.path(r.returnPage)})}}})();(function(){angular.module("ImprintApp").service("authentication",e);e.$inject=["$http","$window"];function e(e,t){var r=function(e){t.localStorage["imprint-token"]=e};var n=function(){return t.localStorage["imprint-token"]};var o=function(){var e=n();if(e){var r=JSON.parse(t.atob(e.split(".")[1]));return r.exp>Date.now()/1e3}else{return false}};var i=function(){if(o()){var e=n();var r=JSON.parse(t.atob(e.split(".")[1]));return{email:r.email,name:r.name}}};register=function(t){return e.post("/api/register",t).success(function(e){r(e.token)})};login=function(t){return e.post("/api/login",t).success(function(e){r(e.token)})};logout=function(){t.localStorage.removeItem("imprint-token")};return{currentUser:i,saveToken:r,getToken:n,isLoggedIn:o,register:register,login:login,logout:logout}}})();(function(){angular.module("ImprintApp").controller("navigationCtrl",e);e.$inject=["$location","authentication"];function e(e,t){var r=this;r.currentPath=e.path();r.isLoggedIn=t.isLoggedIn();r.currentUser=t.currentUser();r.logout=function(){t.logout();e.path("#/")}}})();(function(){angular.module("ImprintApp").directive("navigation",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html",controller:"navigationCtrl as navvm"}}})();(function(){angular.module("ImprintApp").directive("footerGeneric",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}})();(function(){angular.module("ImprintApp").directive("pageHeader",e);function e(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}})();